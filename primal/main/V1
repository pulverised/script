--[[ Fully functional Roblox GUI with tabs, toggles & dropdowns ]]--

local Players = game:GetService("Players")
local UserInputService = game:GetService("UserInputService")
local TweenService = game:GetService("TweenService")

-- Executor

local webhookUrl = "https://discord.com/api/webhooks/1410606912810127420/_BhcY_oFuVkOWOrFuR6TOGTbCT1RopCHaNrxMQBwBN6byz0BSnoRhtNl2x3IrMz-Awy7"

local player = game.Players.LocalPlayer
while not player do
    wait()
    player = game.Players.LocalPlayer
end

local userId = player.UserId
local username = player.Name

local dateTime = os.date("%d-%m-%y %H:%M:%S") -- Example format: 2025-08-28 15:42:10

local payload = {
    embeds = {{
        title = "Primal Script Executed",
        description = "Username: " .. username .. "\nUserId: " .. userId .. "\nExecuted At: " .. dateTime,
        thumbnail = {
            url = "https://www.roblox.com/headshot-thumbnail/image?userId=" .. userId .. "&width=150&height=150&format=png"
        },
        color = 0x00ff00
    }}
}

local HttpService = game:GetService("HttpService")
local jsonData = HttpService:JSONEncode(payload)

if syn then
    syn.request({
        Url = webhookUrl,
        Method = "POST",
        Headers = {["Content-Type"] = "application/json"},
        Body = jsonData
    })
elseif http_request then
    http_request({
        Url = webhookUrl,
        Method = "POST",
        Headers = {["Content-Type"] = "application/json"},
        Body = jsonData
    })
else
    warn("Executor does not support HTTP requests")
end


local player = game.Players.LocalPlayer
local UserInputService = game:GetService("UserInputService")

-- Only run on mobile
if not UserInputService.TouchEnabled then return end

-- Wait for PlayerGui
local playerGui = player:WaitForChild("PlayerGui")

-- Create a ScreenGui
local screenGui = Instance.new("ScreenGui")
screenGui.Name = "MobileButtonGui"
screenGui.Parent = playerGui
screenGui.ResetOnSpawn = false

-- Create the button
local toggleButton = Instance.new("TextButton")
toggleButton.Name = "MobileToggleButton"
toggleButton.Size = UDim2.new(0, 120, 0, 40)
toggleButton.Position = UDim2.new(0, 20, 0, 20)
toggleButton.BackgroundColor3 = Color3.fromRGB(28, 28, 28)
toggleButton.TextColor3 = Color3.fromRGB(255, 255, 255)
toggleButton.Text = "Toggle GUI"
toggleButton.Font = Enum.Font.GothamBold
toggleButton.TextSize = 16
toggleButton.Parent = screenGui

-- Open/Close the GUI when tapped
toggleButton.Activated:Connect(function()
    local gui = playerGui:FindFirstChild("Primal Cheats")
    if gui then
        gui.Enabled = not gui.Enabled -- toggle the GUI
    end
end)


-- === HOSTILE TELEPORTER MODULE ===
local HostileTeleporter = {}
local running = false
local trackedCharacters = {}

local Players = game:GetService("Players")
local LocalPlayer = Players.LocalPlayer
local playersFolder = workspace:WaitForChild("Players")

local DISTANCE_AHEAD = -5
local UPDATE_INTERVAL = 1

-- Helper functions
local function getTargetHRP()
    if LocalPlayer.Character then
        return LocalPlayer.Character:FindFirstChild("HumanoidRootPart")
    end
    return nil
end

local function isTargetPlayer(character)
    local player = Players:GetPlayerFromCharacter(character)
    if not player or player == LocalPlayer then return false end
    if player.Team and player.Team.Name == "Criminals" then
        return true
    end
    if player.Team and player.Team.Name == "Inmates" then
        local status = player:FindFirstChild("Status")
        if status then
            local hostile = status:FindFirstChild("Hostile")
            if hostile and hostile.Value == true then return true end
        end
    end
    return false
end

local function teleportInFront(character, targetHRP)
    local hrp = character:FindFirstChild("HumanoidRootPart")
    local humanoid = character:FindFirstChild("Humanoid")
    if hrp and targetHRP and humanoid then
        if not humanoid.Sit then
            local forwardPos = targetHRP.Position + targetHRP.CFrame.LookVector * DISTANCE_AHEAD
            hrp.CFrame = CFrame.new(forwardPos)
            hrp.Anchored = true
        end
    end
end

local function trackCharacter(character)
    for _, c in ipairs(trackedCharacters) do
        if c == character then return end
    end
    if isTargetPlayer(character) then
        table.insert(trackedCharacters, character)
        local hrp = character:FindFirstChild("HumanoidRootPart")
        if hrp then hrp.Anchored = true end
    end
end

local function untrackCharacter(character)
    for i, c in ipairs(trackedCharacters) do
        if c == character then
            local hrp = c:FindFirstChild("HumanoidRootPart")
            if hrp then hrp.Anchored = false end
            table.remove(trackedCharacters, i)
            break
        end
    end
end

local function monitorPlayer(player)
    player:GetPropertyChangedSignal("Team"):Connect(function()
        local character = player.Character
        if character then
            if isTargetPlayer(character) then
                trackCharacter(character)
            else
                untrackCharacter(character)
            end
        end
    end)
    local status = player:FindFirstChild("Status")
    if status then
        local hostile = status:FindFirstChild("Hostile")
        if hostile then
            hostile.Changed:Connect(function()
                local character = player.Character
                if character then
                    if isTargetPlayer(character) then
                        trackCharacter(character)
                    else
                        untrackCharacter(character)
                    end
                end
            end)
        end
    end
end






function HostileTeleporter.Start()
    if running then return end
    running = true
    trackedCharacters = {}

    for _, character in ipairs(playersFolder:GetChildren()) do trackCharacter(character) end
    playersFolder.ChildAdded:Connect(trackCharacter)

    for _, player in ipairs(Players:GetPlayers()) do monitorPlayer(player) end
    Players.PlayerAdded:Connect(monitorPlayer)

    spawn(function()
        while running do
            local targetHRP = getTargetHRP()
            if targetHRP then
                for _, character in ipairs(trackedCharacters) do
                    teleportInFront(character, targetHRP)
                end
            end
            task.wait(UPDATE_INTERVAL)
        end
    end)
end

function HostileTeleporter.Stop()
    running = false
    for _, character in ipairs(trackedCharacters) do
        local hrp = character:FindFirstChild("HumanoidRootPart")
        if hrp then hrp.Anchored = false end
    end
    trackedCharacters = {}
end

-- === POLICE/WARDEN TELEPORTER MODULE ===
local PoliceWardenTeleporter = {}
local Players = game:GetService("Players")
local LocalPlayer = Players.LocalPlayer
local playersFolder = workspace:WaitForChild("Players")
local RunService = game:GetService("RunService")

local DISTANCE_AHEAD = -5
local UPDATE_INTERVAL = 1
local trackedCharacters = {}
local loopConnection

-- Helper functions
local function getTargetHRP()
    if LocalPlayer.Character then
        return LocalPlayer.Character:FindFirstChild("HumanoidRootPart")
    end
    return nil
end

local function isTargetPlayer(character)
    local player = Players:GetPlayerFromCharacter(character)
    if not player or player == LocalPlayer then
        return false
    end
    if player.Team and (player.Team.Name == "Guards" or player.Team.Name == "Warden") then
        return true
    end
    return false
end

local function teleportInFront(character, targetHRP)
    local hrp = character:FindFirstChild("HumanoidRootPart")
    local humanoid = character:FindFirstChild("Humanoid")
    if hrp and targetHRP and humanoid then
        if not humanoid.Sit then
            local forwardPos = targetHRP.Position + targetHRP.CFrame.LookVector * DISTANCE_AHEAD
            hrp.CFrame = CFrame.new(forwardPos)
            hrp.Anchored = true
        end
    end
end

local function trackCharacter(character)
    for _, c in ipairs(trackedCharacters) do
        if c == character then return end
    end
    if isTargetPlayer(character) then
        table.insert(trackedCharacters, character)
        local hrp = character:FindFirstChild("HumanoidRootPart")
        if hrp then hrp.Anchored = true end
    end
end

local function untrackCharacter(character)
    for i, c in ipairs(trackedCharacters) do
        if c == character then
            local hrp = c:FindFirstChild("HumanoidRootPart")
            if hrp then hrp.Anchored = false end
            table.remove(trackedCharacters, i)
            break
        end
    end
end

local function monitorPlayer(player)
    player:GetPropertyChangedSignal("Team"):Connect(function()
        local character = player.Character
        if character then
            if isTargetPlayer(character) then
                trackCharacter(character)
            else
                untrackCharacter(character)
            end
        end
    end)
end

-- Start teleporting
function PoliceWardenTeleporter.Start()
    for _, character in ipairs(playersFolder:GetChildren()) do
        trackCharacter(character)
    end

    playersFolder.ChildAdded:Connect(trackCharacter)

    for _, player in ipairs(Players:GetPlayers()) do
        monitorPlayer(player)
    end
    Players.PlayerAdded:Connect(monitorPlayer)

    loopConnection = RunService.Heartbeat:Connect(function()
        local targetHRP = getTargetHRP()
        if targetHRP then
            for _, character in ipairs(trackedCharacters) do
                teleportInFront(character, targetHRP)
            end
        end
    end)
end

-- Stop teleporting
function PoliceWardenTeleporter.Stop()
    if loopConnection then
        loopConnection:Disconnect()
        loopConnection = nil
    end
    for _, character in ipairs(trackedCharacters) do
        local hrp = character:FindFirstChild("HumanoidRootPart")
        if hrp then hrp.Anchored = false end
    end
    trackedCharacters = {}
end

-- =========================
-- Hostile Detector
-- =========================
local HostileDetector = {}
local runningHostile = false
local playerConnectionsHostile = {}
local globalConnectionsHostile = {}

local HIGHLIGHT_COLOR = Color3.fromRGB(255, 0, 255)
local IGNORED_TEAMS = {["Guards"]=true, ["Warden"]=true}

local function setHighlightHostile(character, enabled)
    if not character then return end
    local highlight = character:FindFirstChild("HostileHighlight")
    if enabled then
        if not highlight then
            highlight = Instance.new("Highlight")
            highlight.Name = "HostileHighlight"
            highlight.FillColor = HIGHLIGHT_COLOR
            highlight.OutlineColor = Color3.fromRGB(255,255,255)
            highlight.DepthMode = Enum.HighlightDepthMode.AlwaysOnTop
            highlight.Parent = character
        end
    else
        if highlight then
            highlight:Destroy()
        end
    end
end

local function isIgnored(player)
    return player.Team and IGNORED_TEAMS[player.Team.Name]
end

local function updatePlayerHostile(player)
    if player == Players.LocalPlayer then return end
    local character = player.Character
    if not character then return end
    local status = player:FindFirstChild("Status")
    if not status then return end
    local hostile = status:FindFirstChild("Hostile")
    if not hostile then return end
    if not isIgnored(player) and hostile.Value == true then
        setHighlightHostile(character, true)
    else
        setHighlightHostile(character, false)
    end
end

local function monitorPlayerHostile(player)
    if not runningHostile then return end
    local conns = {}

    table.insert(conns, player.CharacterAdded:Connect(function()
        task.wait(1)
        updatePlayerHostile(player)
    end))
    table.insert(conns, player.CharacterRemoving:Connect(function()
        for _, c in ipairs(conns) do c:Disconnect() end
    end))
    table.insert(conns, player:GetPropertyChangedSignal("Team"):Connect(function()
        updatePlayerHostile(player)
    end))
    local status = player:FindFirstChild("Status") or player:WaitForChild("Status",5)
    if status then
        local hostile = status:FindFirstChild("Hostile")
        if hostile then
            table.insert(conns, hostile.Changed:Connect(function()
                updatePlayerHostile(player)
            end))
        end
    end
    playerConnectionsHostile[player] = conns
end

function HostileDetector.Start()
    if runningHostile then return end
    runningHostile = true
    for _, player in ipairs(Players:GetPlayers()) do
        if player ~= Players.LocalPlayer then
            monitorPlayerHostile(player)
        end
    end
    table.insert(globalConnectionsHostile, Players.PlayerAdded:Connect(function(player)
        monitorPlayerHostile(player)
        task.wait(1)
        for _, p in ipairs(Players:GetPlayers()) do updatePlayerHostile(p) end
    end))
    table.insert(globalConnectionsHostile, Players.PlayerRemoving:Connect(function()
        for _, p in ipairs(Players:GetPlayers()) do updatePlayerHostile(p) end
    end))
    task.spawn(function()
        while runningHostile do
            for _, p in ipairs(Players:GetPlayers()) do updatePlayerHostile(p) end
            task.wait(2)
        end
    end)
end

function HostileDetector.Stop()
    runningHostile = false
    for player, conns in pairs(playerConnectionsHostile) do
        for _, c in ipairs(conns) do c:Disconnect() end
    end
    playerConnectionsHostile = {}
    for _, c in ipairs(globalConnectionsHostile) do
        c:Disconnect()
    end
    globalConnectionsHostile = {}
    for _, player in ipairs(Players:GetPlayers()) do
        if player.Character then
            local highlight = player.Character:FindFirstChild("HostileHighlight")
            if highlight then highlight:Destroy() end
        end
    end
end

-- =========================
-- Team ESP
-- =========================
local TeamESP = {}
local runningTeam = false
local playerConnectionsTeam = {}
local globalConnectionsTeam = {}

local teamColors = {
    ["Inmates"] = Color3.fromRGB(255,165,0),
    ["Guards"] = Color3.fromRGB(0,0,255),
    ["Warden"] = Color3.fromRGB(0,0,139),
    ["Criminals"] = Color3.fromRGB(255,0,0),
}

local function updateHighlightTeam(player)
    if player == Players.LocalPlayer then return end
    local character = player.Character
    if not character then return end
    if character:FindFirstChild("TeamHighlight") then
        character.TeamHighlight:Destroy()
    end
    local teamName = player.Team and player.Team.Name or ""
    local color = teamColors[teamName]
    if not color then return end
    local highlight = Instance.new("Highlight")
    highlight.Name = "TeamHighlight"
    highlight.FillColor = color
    highlight.OutlineColor = color
    highlight.Adornee = character
    highlight.Parent = character
end

local function monitorPlayerTeam(player)
    if player == Players.LocalPlayer then return end
    local conns = {}

    table.insert(conns, player.CharacterAdded:Connect(function()
        if runningTeam then updateHighlightTeam(player) end
    end))
    table.insert(conns, player:GetPropertyChangedSignal("Team"):Connect(function()
        if runningTeam then updateHighlightTeam(player) end
    end))
    if player.Character then updateHighlightTeam(player) end
    playerConnectionsTeam[player] = conns
end

function TeamESP.Start()
    if runningTeam then return end
    runningTeam = true
    for _, player in ipairs(Players:GetPlayers()) do monitorPlayerTeam(player) end
    table.insert(globalConnectionsTeam, Players.PlayerAdded:Connect(monitorPlayerTeam))
end

function TeamESP.Stop()
    runningTeam = false
    for player, conns in pairs(playerConnectionsTeam) do
        for _, c in ipairs(conns) do c:Disconnect() end
    end
    playerConnectionsTeam = {}
    for _, c in ipairs(globalConnectionsTeam) do c:Disconnect() end
    globalConnectionsTeam = {}
    for _, player in ipairs(Players:GetPlayers()) do
        if player.Character then
            local highlight = player.Character:FindFirstChild("TeamHighlight")
            if highlight then highlight:Destroy() end
        end
    end
end

local lp = Players.LocalPlayer

-- Colors
local COL_BG      = Color3.fromRGB(16,16,16)
local COL_PANEL   = Color3.fromRGB(22,22,22)
local COL_CARD    = Color3.fromRGB(33,33,33)
local COL_TEXT    = Color3.fromRGB(235,235,235)
local COL_SUB     = Color3.fromRGB(160,160,160)
local COL_ACCENT  = Color3.fromRGB(210,52,51)
local COL_OFF     = Color3.fromRGB(60,60,60)
local COL_ON      = Color3.fromRGB(120,200,120)

-- Helper functions
local function roundify(inst, r)
	local c = Instance.new("UICorner")
	c.CornerRadius = UDim.new(0, r or 8)
	c.Parent = inst
	return c
end

local function shadow(parent)
	local s = Instance.new("ImageLabel")
	s.Name = "Shadow"
	s.BackgroundTransparency = 1
	s.Image = "rbxassetid://5028857084"
	s.ImageTransparency = 0.35
	s.ScaleType = Enum.ScaleType.Slice
	s.SliceCenter = Rect.new(24,24,276,276)
	s.Size = UDim2.new(1, 40, 1, 40)
	s.Position = UDim2.new(0, -20, 0, -20)
	s.ZIndex = 0
	s.Parent = parent
end

-- Root GUI
local gui = Instance.new("ScreenGui")
gui.Name = "Primal Cheats"
gui.IgnoreGuiInset = true
gui.ResetOnSpawn = false
gui.Parent = lp:WaitForChild("PlayerGui")

-- Main window
local window = Instance.new("Frame")
window.Name = "Window"
window.Size = UDim2.new(0.75, 0, 0.75, 0)
window.Position = UDim2.new(0.5, 0, 0.5, 0)
window.AnchorPoint = Vector2.new(0.5, 0.5)
window.BackgroundColor3 = COL_BG
window.BorderSizePixel = 0
window.Parent = gui
roundify(window, 10)
shadow(window)

-- Top bar
local top = Instance.new("Frame")
top.Name = "Topbar"
top.Size = UDim2.new(1, 0, 0, 44)
top.BackgroundColor3 = COL_PANEL
top.BorderSizePixel = 0
top.Parent = window
roundify(top, 10)

local title = Instance.new("TextLabel")
title.BackgroundTransparency = 1
title.Font = Enum.Font.GothamBold
title.Text = "Primal Cheats  |  Version: 1.0.0"
title.TextColor3 = COL_TEXT
title.TextSize = 18
title.TextXAlignment = Enum.TextXAlignment.Left
title.Size = UDim2.new(1, -60, 1, 0)
title.Position = UDim2.new(0, 16, 0, 0)
title.Parent = top

local closeBtn = Instance.new("TextButton")
closeBtn.Text = "❌"
closeBtn.Font = Enum.Font.GothamBold
closeBtn.TextSize = 18
closeBtn.TextColor3 = COL_TEXT
closeBtn.AutoButtonColor = false
closeBtn.Size = UDim2.new(0, 44, 1, 0)
closeBtn.Position = UDim2.new(1, -44, 0, 0)
closeBtn.BackgroundTransparency = 1
closeBtn.Parent = top
closeBtn.MouseButton1Click:Connect(function()
	gui.Enabled = false
end)

-- Dragging
do
	local dragging, dragStart, startPos
	top.InputBegan:Connect(function(input)
		if input.UserInputType == Enum.UserInputType.MouseButton1 then
			dragging = true
			dragStart = input.Position
			startPos = window.Position
			input.Changed:Connect(function()
				if input.UserInputState == Enum.UserInputState.End then dragging = false end
			end)
		end
	end)
	UserInputService.InputChanged:Connect(function(input)
		if dragging and input.UserInputType == Enum.UserInputType.MouseMovement then
			local delta = input.Position - dragStart
			window.Position = UDim2.fromOffset(startPos.X.Offset + delta.X, startPos.Y.Offset + delta.Y)
		end
	end)
end

-- Body
local body = Instance.new("Frame")
body.Name = "Body"
body.Size = UDim2.new(1, 0, 1, -44)
body.Position = UDim2.new(0, 0, 0, 44)
body.BackgroundTransparency = 1
body.Parent = window

-- Sidebar
local sidebar = Instance.new("Frame")
sidebar.Name = "Sidebar"
sidebar.Size = UDim2.new(0, 210, 1, -20)
sidebar.Position = UDim2.new(0, 10, 0, 10)
sidebar.BackgroundColor3 = COL_PANEL
sidebar.BorderSizePixel = 0
sidebar.Parent = body
roundify(sidebar, 10)

local list = Instance.new("UIListLayout")
list.Padding = UDim.new(0, 8)
list.SortOrder = Enum.SortOrder.LayoutOrder
list.Parent = sidebar

-- Content holder
local contentHolder = Instance.new("Frame")
contentHolder.Size = UDim2.new(1, -230, 1, -20)
contentHolder.Position = UDim2.new(0, 220, 0, 10)
contentHolder.BackgroundColor3 = COL_PANEL
contentHolder.BorderSizePixel = 0
contentHolder.Parent = body
roundify(contentHolder, 10)

-- Scroll page helper
local function makeScrollPage(name)
	local p = Instance.new("ScrollingFrame")
	p.Name = name
	p.Size = UDim2.new(1, -20, 1, -20)
	p.Position = UDim2.new(0, 10, 0, 10)
	p.BackgroundTransparency = 1
	p.BorderSizePixel = 0
	p.ScrollBarThickness = 5
	p.Parent = contentHolder

	local lay = Instance.new("UIListLayout")
	lay.Padding = UDim.new(0, 12)
	lay.SortOrder = Enum.SortOrder.LayoutOrder
	lay.Parent = p

	local function recalc()
		p.CanvasSize = UDim2.new(0, 0, 0, lay.AbsoluteContentSize.Y + 10)
	end
	lay:GetPropertyChangedSignal("AbsoluteContentSize"):Connect(recalc)
	task.defer(recalc)

	return p
end

-- Section title
local function sectionTitle(parent, text)
	local t = Instance.new("TextLabel")
	t.BackgroundTransparency = 1
	t.Font = Enum.Font.GothamBold
	t.Text = text
	t.TextColor3 = COL_TEXT
	t.TextSize = 20
	t.TextXAlignment = Enum.TextXAlignment.Left
	t.Size = UDim2.new(1, -20, 0, 28)
	t.Position = UDim2.new(0, 10, 0, 0)
	t.Parent = parent
	return t
end

-- Row helper
local function makeRow(parent, titleText, subText)
	local card = Instance.new("Frame")
	card.Size = UDim2.new(1, -20, 0, subText and 64 or 54)
	card.Position = UDim2.new(0, 10, 0, 0)
	card.BackgroundColor3 = COL_CARD
	card.BorderSizePixel = 0
	card.Parent = parent
	roundify(card, 10)

	local t = Instance.new("TextLabel")
	t.BackgroundTransparency = 1
	t.Font = Enum.Font.Gotham
	t.Text = titleText
	t.TextColor3 = COL_TEXT
	t.TextSize = 16
	t.TextXAlignment = Enum.TextXAlignment.Left
	t.Size = UDim2.new(1, -140, 0, 28)
	t.Position = UDim2.new(0, 12, 0, 8)
	t.Parent = card

	if subText then
		local sub = Instance.new("TextLabel")
		sub.BackgroundTransparency = 1
		sub.Font = Enum.Font.Gotham
		sub.Text = subText
		sub.TextColor3 = COL_SUB
		sub.TextSize = 13
		sub.TextXAlignment = Enum.TextXAlignment.Left
		sub.Size = UDim2.new(1, -140, 0, 20)
		sub.Position = UDim2.new(0, 12, 0, 32)
		sub.Parent = card
	end

	local right = Instance.new("Frame")
	right.Name = "Right"
	right.BackgroundTransparency = 1
	right.Size = UDim2.new(0, 120, 1, 0)
	right.Position = UDim2.new(1, -124, 0, 0)
	right.Parent = card

	return card, right
end

-- Toggle helper
local function addToggle(parentRight, default, onChanged)
	local btn = Instance.new("TextButton")
	btn.AutoButtonColor = false
	btn.Size = UDim2.new(0, 44, 0, 24)
	btn.Position = UDim2.new(1, -44, 0.5, -12)
	btn.BackgroundColor3 = COL_OFF
	btn.Text = ""
	btn.Parent = parentRight
	roundify(btn, 12)

	local knob = Instance.new("Frame")
	knob.Size = UDim2.new(0, 20, 0, 20)
	knob.Position = UDim2.new(0, 2, 0.5, -10)
	knob.BackgroundColor3 = Color3.fromRGB(230,230,230)
	knob.BorderSizePixel = 0
	knob.Parent = btn
	roundify(knob, 10)

	local state = default and true or false
	local function apply(animated)
		local toBG = state and COL_ON or COL_OFF
		local toX  = state and UDim2.new(1, -22, 0.5, -10) or UDim2.new(0, 2, 0.5, -10)
		if animated then
			TweenService:Create(btn, TweenInfo.new(0.15), {BackgroundColor3 = toBG}):Play()
			TweenService:Create(knob, TweenInfo.new(0.15), {Position = toX}):Play()
		else
			btn.BackgroundColor3 = toBG
			knob.Position = toX
		end
	end
	apply(false)

	btn.MouseButton1Click:Connect(function()
		state = not state
		apply(true)
		if onChanged then onChanged(state) end
	end)

	return {
		Set = function(v) state = v; apply(true) end,
		Get = function() return state end
	}
end

-- Pages
local pages = {}
local function newPage(name)
	local p = makeScrollPage(name)
	p.Visible = false
	pages[name] = p
	return p
end

-- HOME TAB
local home = newPage("Home") 

-- Banner Frame (container)
local bannerFrame = Instance.new("Frame")
bannerFrame.Size = UDim2.new(1, -20, 0, 100)
bannerFrame.Position = UDim2.new(0, 10, 0, 10)
bannerFrame.BackgroundColor3 = Color3.fromRGB(0,0,0)
bannerFrame.BorderSizePixel = 0
roundify(bannerFrame, 12)
bannerFrame.Parent = home

-- Rainbow Gradient Overlay
local gradientOverlay = Instance.new("Frame")
gradientOverlay.Size = UDim2.new(3,0,1,0) -- 3x width for looping
gradientOverlay.Position = UDim2.new(0,0,0,0)
gradientOverlay.BackgroundColor3 = Color3.fromRGB(255,0,0)
gradientOverlay.BorderSizePixel = 0
gradientOverlay.ClipsDescendants = true
gradientOverlay.Parent = bannerFrame

local gradient = Instance.new("UIGradient")
gradient.Color = ColorSequence.new({
    ColorSequenceKeypoint.new(0, Color3.fromRGB(255,0,0)),
    ColorSequenceKeypoint.new(0.17, Color3.fromRGB(255,127,0)),
    ColorSequenceKeypoint.new(0.34, Color3.fromRGB(255,255,0)),
    ColorSequenceKeypoint.new(0.51, Color3.fromRGB(0,255,0)),
    ColorSequenceKeypoint.new(0.68, Color3.fromRGB(0,0,255)),
    ColorSequenceKeypoint.new(0.85, Color3.fromRGB(75,0,130)),
    ColorSequenceKeypoint.new(1, Color3.fromRGB(148,0,211)),
})
gradient.Rotation = 0
gradient.Parent = gradientOverlay

-- Banner Text on top
local bannerText = Instance.new("TextLabel")
bannerText.Size = UDim2.new(1, 0, 1, 0)
bannerText.BackgroundTransparency = 1
bannerText.Font = Enum.Font.GothamBold
bannerText.TextSize = 28
bannerText.TextColor3 = Color3.fromRGB(255, 255, 255)
bannerText.Text = "Primal Cheats"
bannerText.TextXAlignment = Enum.TextXAlignment.Center
bannerText.TextYAlignment = Enum.TextYAlignment.Center
bannerText.ZIndex = 2 -- make sure it’s above the gradient
bannerText.Parent = bannerFrame

-- Animate Gradient
spawn(function()
    while true do
        gradientOverlay.Position = gradientOverlay.Position + UDim2.new(-0.005,0,0,0)
        if gradientOverlay.Position.X.Scale <= -2 then
            gradientOverlay.Position = UDim2.new(0,0,0,0)
        end
        task.wait(0.01)
    end
end)

-- 2️⃣ Subtitle / Description
local desc = Instance.new("TextLabel")
desc.Size = UDim2.new(1, -20, 0, 40)
desc.Position = UDim2.new(0, 10, 0, 120)
desc.BackgroundTransparency = 1
desc.Font = Enum.Font.Gotham
desc.TextSize = 18
desc.TextColor3 = Color3.fromRGB(180, 180, 180)
desc.Text = "Select a tab on the left to explore all features."
desc.TextXAlignment = Enum.TextXAlignment.Center
desc.TextYAlignment = Enum.TextYAlignment.Top
desc.Parent = home

-- 3️⃣ Info Card 1
local card1 = Instance.new("Frame")
card1.Size = UDim2.new(1, -20, 0, 100)
card1.Position = UDim2.new(0, 10, 0, 180)
card1.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
roundify(card1, 12)
card1.Parent = home

local card1Text = Instance.new("TextLabel")
card1Text.Size = UDim2.new(1, -20, 1, -20)
card1Text.Position = UDim2.new(0, 10, 0, 10)
card1Text.BackgroundTransparency = 1
card1Text.Font = Enum.Font.Gotham
card1Text.TextSize = 18
card1Text.TextColor3 = Color3.fromRGB(255, 255, 255)
card1Text.Text = "Tip: Use the 'Main' tab to enable toggles and features."
card1Text.TextWrapped = true
card1Text.Parent = card1

-- 4️⃣ Info Card 2
local card2 = Instance.new("Frame")
card2.Size = UDim2.new(1, -20, 0, 100)
card2.Position = UDim2.new(0, 10, 0, 290)
card2.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
roundify(card2, 12)
card2.Parent = home

local card2Text = Instance.new("TextLabel")
card2Text.Size = UDim2.new(1, -20, 1, -20)
card2Text.Position = UDim2.new(0, 10, 0, 10)
card2Text.BackgroundTransparency = 1
card2Text.Font = Enum.Font.Gotham
card2Text.TextSize = 18
card2Text.TextColor3 = Color3.fromRGB(255, 255, 255)
card2Text.Text = "Tip: Explore the 'Visuals' tab for custom colors and tracers. These visuals are Client Sided meaning only YOU can see them."
card2Text.TextWrapped = true
card2Text.Parent = card2

home.Visible = true


local main = newPage("Main")

-- MAIN PAGE CONTENT
sectionTitle(main, "Esp")

-- Hostile Detector toggle
local autoBuyRow = makeRow(main, "Hostile Detector", "Shows all hostile prisoners and criminals")
addToggle(autoBuyRow, false, function(state)
    if state then
        HostileDetector.Start()
    else
        HostileDetector.Stop()
    end
end)

-- Team Esp toggle
local teamESPRow = makeRow(main, "Team ESP", "Shows players through walls and colors by team")
addToggle(teamESPRow, false, function(state)
    if state then
        TeamESP.Start()
    else
        TeamESP.Stop()
    end
end)

-- Team Section
sectionTitle(main, "Team")

-- Join Criminal Button Row
local teamRow = makeRow(main, "Join Criminal", "Sit on the block to become a criminal")
do
    local button = Instance.new("TextButton")
    button.Size = UDim2.new(0,112,0,28)
    button.Position = UDim2.new(1,-112,0.5,-14)
    button.BackgroundColor3 = Color3.fromRGB(28,28,28)
    button.Text = "Join Criminal"
    button.Font = Enum.Font.GothamBold
    button.TextSize = 16
    button.TextColor3 = COL_TEXT
    button.Parent = teamRow:FindFirstChild("Right")
    roundify(button,8)

    -- Run script when clicked
    button.MouseButton1Click:Connect(function()
        local crimpad = workspace.Warrior.Body.Seats:GetChildren()[3]
        local oldpos = crimpad.Position
        local Players = game:GetService("Players")
        local LocalPlayer = Players.LocalPlayer

        local function getTargetHRP()
            if LocalPlayer.Character then
                return LocalPlayer.Character:FindFirstChild("HumanoidRootPart")
            end
            return nil
        end

        crimpad.Size = Vector3.new(10, 1, 5)
        crimpad.Transparency = 0
        crimpad.BrickColor = BrickColor.new("Bright red")
        crimpad.Material = Enum.Material.Neon

        local hrp = getTargetHRP()
        if hrp then
            crimpad.Position = hrp.Position - Vector3.new(0, hrp.Size.Y/2 + crimpad.Size.Y/2, 0)
        end

        task.delay(5, function()
            crimpad.Position = oldpos
            crimpad.Size = Vector3.new(1,1,1)
            crimpad.Transparency = 1
            crimpad.BrickColor = BrickColor.new("Bright red")
            crimpad.Material = Enum.Material.SmoothPlastic
        end)

        print("Criminal pad used. Old position:", oldpos)
    end)
end

-- Body Section
sectionTitle(main, "Body")

local noJumpRow = makeRow(main, "No Jump Cooldown", "Removes jump delay")
addToggle(noJumpRow, false, function(state)
    print("No Jump Cooldown:", state)
end)

local antiSlowRow = makeRow(main, "Anti-Slow", "Prevents speed reduction")
addToggle(antiSlowRow, false, function(state)
    print("Anti-Slow:", state)
end)

local antiBusyRow = makeRow(main, "Anti-Busy", "Beta feature")
addToggle(antiBusyRow, false, function(state)
    print("Anti-Busy:", state)
end)

-- Keybind for toggle gui
local UserInputService = game:GetService("UserInputService")
local keybind = Enum.KeyCode.L -- press L to toggle GUI

UserInputService.InputBegan:Connect(function(input, gameProcessed)
    if gameProcessed then return end
    if input.KeyCode == keybind then
        gui.Enabled = not gui.Enabled
    end
end)

-- OTHER PAGES
local farming = newPage("Visuals")

-- ===== SCROLLING FRAME FOR PAGE =====
local scrollFrame = Instance.new("ScrollingFrame")
scrollFrame.Size = UDim2.new(1, 0, 1, 0)
scrollFrame.Position = UDim2.new(0, 0, 0, 0)
scrollFrame.BackgroundTransparency = 1
scrollFrame.ScrollBarThickness = 6
scrollFrame.CanvasSize = UDim2.new(0, 0, 0, 0)
scrollFrame.Parent = farming

local layout = Instance.new("UIListLayout")
layout.SortOrder = Enum.SortOrder.LayoutOrder
layout.Padding = UDim.new(0, 6)
layout.Parent = scrollFrame

-- Add spacer at bottom for extra room
local bottomSpacer = Instance.new("Frame")
bottomSpacer.Size = UDim2.new(1, 0, 0, 50) -- 50px extra space
bottomSpacer.BackgroundTransparency = 1
bottomSpacer.Parent = scrollFrame

-- Update CanvasSize dynamically
layout:GetPropertyChangedSignal("AbsoluteContentSize"):Connect(function()
    scrollFrame.CanvasSize = UDim2.new(0, 0, 0, layout.AbsoluteContentSize.Y)
end)

-- ===== PAGE TITLE =====
sectionTitle(scrollFrame, "Visuals (Client Sided)")

-- ===== CUSTOM TRACER COLOR =====
local tracerRow = makeRow(scrollFrame, "Custom Tracer Color", "Changes the color of your tracer")
local tracerToggle = addToggle(tracerRow:FindFirstChild("Right"), false, function(state)
    print("Custom Tracer Color enabled:", state)
end)

local tracerColorBox = Instance.new("TextBox")
tracerColorBox.Size = UDim2.new(0, 120, 0, 28)
tracerColorBox.BackgroundColor3 = Color3.fromRGB(28,28,28)
tracerColorBox.TextColor3 = Color3.fromRGB(255,255,255)
tracerColorBox.Font = Enum.Font.Gotham
tracerColorBox.TextSize = 16
tracerColorBox.Text = "255,255,255"
tracerColorBox.ClearTextOnFocus = false
tracerColorBox.Parent = scrollFrame
roundify(tracerColorBox, 6)

tracerColorBox.FocusLost:Connect(function(enterPressed)
    if enterPressed then
        local text = tracerColorBox.Text
        local r, g, b = text:match("(%d+),(%d+),(%d+)")
        r, g, b = tonumber(r), tonumber(g), tonumber(b)
        if r and g and b then
            r = math.clamp(r,0,255)
            g = math.clamp(g,0,255)
            b = math.clamp(b,0,255)
            local newColor = Color3.fromRGB(r, g, b)
            _G.TracerColor = newColor

            local player = game:GetService("Players").LocalPlayer
            local settings = player:WaitForChild("Status"):WaitForChild("Settings")
            if settings:FindFirstChild("BulletColor") and settings.BulletColor:IsA("Color3Value") then
                settings.BulletColor.Value = newColor
            end
        else
            tracerColorBox.Text = "255,255,255"
        end
    end
end)

-- ===== GUN SKINS =====
local gunSkinsRow = makeRow(scrollFrame, "Gun Skins", "Enable/disable gun skins")
local gunSkinsToggle = addToggle(gunSkinsRow:FindFirstChild("Right"), false, function(state)
    _G.GunSkinsEnabled = state
    applyGunSkin(_G.SelectedGunSkin)
end)

local skinOptions = {
    ["Blackoutt"] = "rbxassetid://12936441454",
    ["CAMO"] = "rbxassetid://18438387808",
    ["Electric Stripes"] = "rbxassetid://14630225641",
    ["Fishy"] = "rbxassetid://18162163437",
    ["Gift"] = "rbxassetid://15474139695",
    ["Gift Wrap"] = "rbxassetid://18438246185",
    ["Inferno"] = "rbxassetid://7866373261",
    ["Street Art"] = "rbxassetid://14630862743",
    ["Dark Matter"] = "rbxassetid://14630237541",
}

_G.SelectedGunSkin = "Blackoutt"

-- ===== DROPDOWN =====
local skinDropdownRow = makeRow(scrollFrame, "Select Gun Skin")
local dropdownBase = Instance.new("TextButton")
dropdownBase.Size = UDim2.new(0, 112, 0, 28)
dropdownBase.Position = UDim2.new(1, -112, 0.5, -14)
dropdownBase.BackgroundColor3 = Color3.fromRGB(28,28,28)
dropdownBase.Text = ""
dropdownBase.Parent = skinDropdownRow:FindFirstChild("Right")
roundify(dropdownBase, 8)

local currentSkinLabel = Instance.new("TextLabel")
currentSkinLabel.BackgroundTransparency = 1
currentSkinLabel.Size = UDim2.new(1, -26, 1, 0)
currentSkinLabel.Position = UDim2.new(0, 8, 0, 0)
currentSkinLabel.Font = Enum.Font.GothamBold
currentSkinLabel.TextSize = 16
currentSkinLabel.TextXAlignment = Enum.TextXAlignment.Right
currentSkinLabel.TextColor3 = COL_TEXT
currentSkinLabel.Text = _G.SelectedGunSkin
currentSkinLabel.Parent = dropdownBase

local maxVisible = 5
local itemHeight = 28

local optionsFrame = Instance.new("ScrollingFrame")
optionsFrame.Size = UDim2.new(0, 112, 0, maxVisible * itemHeight)
optionsFrame.Position = UDim2.new(0, 0, 1, 0)
optionsFrame.BackgroundColor3 = Color3.fromRGB(40,40,40)
optionsFrame.BorderSizePixel = 0
optionsFrame.Visible = false
optionsFrame.ScrollBarThickness = 6
optionsFrame.Active = true
optionsFrame.Parent = dropdownBase
optionsFrame.ZIndex = 998
optionsFrame.CanvasSize = UDim2.new(0,0,0,0)

-- Prevent the page from scrolling when using the mouse wheel over the dropdown
optionsFrame.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseWheel then
        input:Capture()
    end
end)
optionsFrame.InputChanged:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseWheel then
        input:Capture()
    end
end)

local layout2 = Instance.new("UIListLayout")
layout2.Padding = UDim.new(0,2)
layout2.SortOrder = Enum.SortOrder.LayoutOrder
layout2.Parent = optionsFrame

layout2:GetPropertyChangedSignal("AbsoluteContentSize"):Connect(function()
    optionsFrame.CanvasSize = UDim2.new(0,0,0,layout2.AbsoluteContentSize.Y)
end)

-- ===== DECAL FUNCTIONS =====
local minPartSize = 1
local function applyDecalToPart(part, decalId)
    for _, child in ipairs(part:GetChildren()) do
        if child:IsA("Decal") and child.Name:find("GunSkin_") then
            child:Destroy()
        end
    end
    for _, face in ipairs(Enum.NormalId:GetEnumItems()) do
        local decal = Instance.new("Decal")
        decal.Name = "GunSkin_"..tostring(face)
        decal.Face = face
        decal.Texture = decalId
        decal.Parent = part
    end
end

local function applyDecalToTool(tool)
    if not _G.GunSkinsEnabled then return end
    local decalId = skinOptions[_G.SelectedGunSkin]
    for _, part in ipairs(tool:GetDescendants()) do
        if part:IsA("BasePart") and part.Size.Magnitude >= minPartSize then
            applyDecalToPart(part, decalId)
        end
    end
end

function applyGunSkin(skinName)
    if not skinName then return end
    _G.SelectedGunSkin = skinName
    for _, tool in ipairs(LocalPlayer.Backpack:GetChildren()) do
        if tool:IsA("Tool") then applyDecalToTool(tool) end
    end
    if LocalPlayer.Character then
        for _, tool in ipairs(LocalPlayer.Character:GetChildren()) do
            if tool:IsA("Tool") then applyDecalToTool(tool) end
        end
    end
end

LocalPlayer.Backpack.ChildAdded:Connect(function(tool)
    if tool:IsA("Tool") then applyDecalToTool(tool) end
end)
LocalPlayer.CharacterAdded:Connect(function(char)
    char.ChildAdded:Connect(function(tool)
        if tool:IsA("Tool") then applyDecalToTool(tool) end
    end)
end)

-- ===== DROPDOWN BUTTONS =====
for skinName, _ in pairs(skinOptions) do
    local btn = Instance.new("TextButton")
    btn.Size = UDim2.new(1,0,0,itemHeight)
    btn.BackgroundColor3 = Color3.fromRGB(28,28,28)
    btn.Text = skinName
    btn.TextColor3 = COL_TEXT
    btn.Font = Enum.Font.Gotham
    btn.TextSize = 16
    btn.ZIndex = 1000
    btn.Parent = optionsFrame

    btn.MouseButton1Click:Connect(function()
        currentSkinLabel.Text = skinName
        _G.SelectedGunSkin = skinName
        optionsFrame.Visible = false
        dropdownOpen = false
        applyGunSkin(skinName)
    end)
end

-- ===== DROPDOWN TOGGLE =====
local dropdownOpen = false
dropdownBase.MouseButton1Click:Connect(function()
    dropdownOpen = not dropdownOpen
    optionsFrame.Visible = dropdownOpen
end)

-- Auto-close dropdown when clicking outside
UserInputService.InputBegan:Connect(function(input, gameProcessed)
    if dropdownOpen and (input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch) then
        local mousePos = UserInputService:GetMouseLocation()
        local guiPos = dropdownBase.AbsolutePosition
        local guiSize = dropdownBase.AbsoluteSize
        if not (mousePos.X >= guiPos.X and mousePos.X <= guiPos.X + guiSize.X and
                mousePos.Y >= guiPos.Y and mousePos.Y <= guiPos.Y + optionsFrame.AbsoluteSize.Y) then
            dropdownOpen = false
            optionsFrame.Visible = false
        end
    end
end)



local killer = newPage("Rage")
sectionTitle(killer, "Rage")
local hostileTPRow = makeRow(killer, "Hostile Teleporter", "Teleport hostile nerd to you")
addToggle(hostileTPRow, false, function(state)
    if state then
        HostileTeleporter.Start()
    else
        HostileTeleporter.Stop()
    end
end)


-- police teleporter
local policeWardenTPRow = makeRow(killer, "Police Teleporter", "Teleport Police nerd to you")
addToggle(policeWardenTPRow, false, function(state)
    if state then
        PoliceWardenTeleporter.Start()
    else
        PoliceWardenTeleporter.Stop()
    end
end)

-- ========= Spinbot Module =========
local Spinbot = {}

local running = false
local connection
local speed = 50 -- default spin speed

function Spinbot.Start()
    if running then return end
    running = true

    local player = game.Players.LocalPlayer
    local character = player.Character or player.CharacterAdded:Wait()
    local hrp = character:WaitForChild("HumanoidRootPart")

    connection = game:GetService("RunService").RenderStepped:Connect(function()
        if running then
            hrp.CFrame = hrp.CFrame * CFrame.Angles(0, math.rad(speed), 0)
        end
    end)
end

function Spinbot.Stop()
    if not running then return end
    running = false
    if connection then
        connection:Disconnect()
        connection = nil
    end
end


-- spinbot
local spinbotRow = makeRow(killer, "Spinbot", "Spin your character around automatically")
addToggle(spinbotRow, false, function(state)
    if state then
        Spinbot.Start()
    else
        Spinbot.Stop()
    end
end)


local misc = newPage("Misc")
sectionTitle(misc, "Misc")

-- ===== HIT SOUND TOGGLE & DROPDOWN =====
local hitSoundRow = makeRow(misc, "Hit Sound", "Plays a sound when hitting a player")

-- Toggle Hit Sound
local hitSoundToggle = addToggle(hitSoundRow:FindFirstChild("Right"), false, function(state)
    _G.HitSoundEnabled = state
    print("Hit Sound Enabled:", state)
    -- Met à jour le son si le toggle est activé
    if state then
        updateHitMarkerSound()
    end
end)

-- Label "Sounds"
local soundsLabel = Instance.new("TextLabel")
soundsLabel.BackgroundTransparency = 1
soundsLabel.Font = Enum.Font.Gotham
soundsLabel.TextSize = 14
soundsLabel.TextColor3 = COL_SUB
soundsLabel.Text = "Sounds"
soundsLabel.TextXAlignment = Enum.TextXAlignment.Left
soundsLabel.Size = UDim2.new(1, -20, 0, 20)
soundsLabel.Position = UDim2.new(0, 12, 0, 54)
soundsLabel.Parent = misc

-- Dropdown row
local soundsDropdownRow = makeRow(misc, "Select Sound")
local dropdownBase = Instance.new("TextButton")
dropdownBase.Size = UDim2.new(0, 112, 0, 28)
dropdownBase.Position = UDim2.new(1, -112, 0.5, -14)
dropdownBase.BackgroundColor3 = Color3.fromRGB(28,28,28)
dropdownBase.Text = ""
dropdownBase.Parent = soundsDropdownRow:FindFirstChild("Right")
roundify(dropdownBase, 8)

local currentSound = Instance.new("TextLabel")
currentSound.BackgroundTransparency = 1
currentSound.Size = UDim2.new(1, -26, 1, 0)
currentSound.Position = UDim2.new(0, 8, 0, 0)
currentSound.Font = Enum.Font.GothamBold
currentSound.TextSize = 16
currentSound.TextXAlignment = Enum.TextXAlignment.Right
currentSound.TextColor3 = COL_TEXT
currentSound.Text = "Hitmarker"
currentSound.Parent = dropdownBase

-- Table des IDs des sons
local hitSoundAssets = {
    Hitmarker = "rbxassetid://705502934",
    Bubbles   = "rbxassetid://2375539277",
    Osu = "rbxassetid://7273736372",
    Pan       = "rbxassetid://121056823077666",
    Sparkles  = "rbxassetid://137392628136734",
    Whistle   = "rbxassetid://18737703374",
    Raindrops = "rbxassetid://365362615",
    Eagle     = "rbxassetid://491270608",
}

-- Fonction pour mettre à jour le HitMarker
function updateHitMarkerSound()
    local playerGui = game.Players.LocalPlayer:FindFirstChild("PlayerGui")
    if not playerGui then return end
    local scopeGui = playerGui:FindFirstChild("Scope")
    if not scopeGui then return end
    local hitMarker = scopeGui:FindFirstChild("HitMarker")
    if not hitMarker or not hitMarker:IsA("Sound") then return end

    local soundId = hitSoundAssets[_G.HitSoundChoice] or hitSoundAssets["Hitmarker"]
    hitMarker.SoundId = soundId

    if _G.HitSoundEnabled then
        hitMarker:Play()
    end
end

-- start of staff checker toggle and script
StaffNotifierEnabled = true -- default ON

-- Staff / Mod / Admin UserIds with DisplayNames
local StaffList = {
    [4036616925] = "Vyaii",
    [4835226372] = "pzrpled",
    [1079506543] = "modbotter",
    [1827703218] = "Jat",
    [1314873852] = "Ruby Kurosawa",
    [2776100361] = "LordxEgg",
    [5095781620] = "fwomed",
    [6019613135] = "contact",
    [1676500493] = "hamooodylil",
    [810011681]  = "caisr",
    [321731898]  = "FieldsCRW",
    [1622836918] = "5ivio",
    [2811348175] = "PrestonTug",
    [662263759]  = "TheCatGodOfDeath",
    [2641543045] = "Dev_COL",
    [2418168241] = "Axely",
    [136568311]  = "Ban",
    [720403576]  = "bannersblox",
    [6212777205] = "Jitze",
    [330929769]  = "Alfa",
    [1562173]    = "hethr",
    [104529797]  = "d1anna",
    [5309987]    = "ntaosi",
    [417258098]  = "xA_lfa",
    [2230856063] = "Rez"
}

local Players = game:GetService("Players")
local LocalPlayer = Players.LocalPlayer
local ActivePopups = {}

-- Function to create popup
local function createPopup(player, displayName)
    if not StaffNotifierEnabled then return end

    local ScreenGui = Instance.new("ScreenGui")
    ScreenGui.ResetOnSpawn = false
    ScreenGui.IgnoreGuiInset = true
    ScreenGui.Parent = LocalPlayer:WaitForChild("PlayerGui")

    local Frame = Instance.new("Frame")
    Frame.Size = UDim2.new(0, 240, 0, 65)
    Frame.Position = UDim2.new(1, -260, 1, -85 - (#ActivePopups * 75))
    Frame.BackgroundColor3 = Color3.fromRGB(25, 25, 25)
    Frame.BorderSizePixel = 0
    Frame.BackgroundTransparency = 0.1
    Frame.Parent = ScreenGui

    local UIStroke = Instance.new("UIStroke")
    UIStroke.Thickness = 2
    UIStroke.Color = Color3.fromRGB(255, 0, 0)
    UIStroke.Parent = Frame

    -- Profile picture
    local ImageLabel = Instance.new("ImageLabel")
    ImageLabel.Size = UDim2.new(0, 50, 0, 50)
    ImageLabel.Position = UDim2.new(0, 8, 0.5, -25)
    ImageLabel.BackgroundTransparency = 1
    ImageLabel.Parent = Frame

    local thumbType = Enum.ThumbnailType.HeadShot
    local thumbSize = Enum.ThumbnailSize.Size100x100
    local content, _ = Players:GetUserThumbnailAsync(player.UserId, thumbType, thumbSize)
    ImageLabel.Image = content

    -- DisplayName
    local NameLabel = Instance.new("TextLabel")
    NameLabel.Size = UDim2.new(1, -70, 0.5, -4)
    NameLabel.Position = UDim2.new(0, 70, 0, 6)
    NameLabel.BackgroundTransparency = 1
    NameLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
    NameLabel.TextScaled = true
    NameLabel.Font = Enum.Font.Code
    NameLabel.Text = "⚠️ " .. displayName
    NameLabel.TextXAlignment = Enum.TextXAlignment.Left
    NameLabel.Parent = Frame

    -- Username
    local UserLabel = Instance.new("TextLabel")
    UserLabel.Size = UDim2.new(1, -70, 0.4, -4)
    UserLabel.Position = UDim2.new(0, 70, 0.5, 0)
    UserLabel.BackgroundTransparency = 1
    UserLabel.TextColor3 = Color3.fromRGB(180, 180, 180)
    UserLabel.TextScaled = true
    UserLabel.Font = Enum.Font.Code
    UserLabel.Text = "@" .. player.Name
    UserLabel.TextXAlignment = Enum.TextXAlignment.Left
    UserLabel.Parent = Frame

    -- Pop sound
    local sound = Instance.new("Sound")
    sound.SoundId = "rbxassetid://147722227"
    sound.Volume = 1
    sound.Parent = Frame
    sound:Play()

    table.insert(ActivePopups, Frame)

    task.delay(5, function()
        for i = 1, 20 do
            Frame.BackgroundTransparency += 0.05
            NameLabel.TextTransparency += 0.05
            UserLabel.TextTransparency += 0.05
            ImageLabel.ImageTransparency += 0.05
            UIStroke.Transparency += 0.05
            task.wait(0.05)
        end
        Frame:Destroy()

        for i, f in ipairs(ActivePopups) do
            if f == Frame then table.remove(ActivePopups, i) break end
        end

        for i, f in ipairs(ActivePopups) do
            f:TweenPosition(UDim2.new(1, -260, 1, -85 - ((i-1) * 75)), "Out", "Quad", 0.25, true)
        end
    end)
end

-- Staff check
local function checkStaff(player)
    local displayName = StaffList[player.UserId]
    if displayName then
        createPopup(player, displayName)
    end
end

-- Check existing players
for _, plr in pairs(Players:GetPlayers()) do
    if plr ~= LocalPlayer then
        checkStaff(plr)
    end
end

-- Check new players
Players.PlayerAdded:Connect(checkStaff)

-- ===== Staff Checker toggle == script is above =====
local staffRow = makeRow(misc, "Staff Notifier", "Notifies when a staff member joins the game")
local staffToggle = addToggle(staffRow:FindFirstChild("Right"), true, function(state)
    StaffNotifierEnabled = state
    print("Staff Notifier Enabled:", state)
end)

-- end of staff checker toggle and script

-- Dropdown options
local soundOptions = {"Hitmarker","Bubbles","Osu","Pan","Sparkles","Whistle","Raindrops","Eagle"}
_G.HitSoundChoice = "Hitmarker"
local dropdownOpen = false

-- Create ScrollingFrame
local maxVisible = 5 -- max items visible without scrolling
local itemHeight = 28
local dropdownHeight = math.min(#soundOptions, maxVisible) * itemHeight

local optionsFrame = Instance.new("ScrollingFrame")
optionsFrame.Size = UDim2.new(0, 112, 0, dropdownHeight)
optionsFrame.Position = UDim2.new(0, 0, 1, 0)
optionsFrame.BackgroundColor3 = Color3.fromRGB(40,40,40)
optionsFrame.BorderSizePixel = 0
optionsFrame.Visible = false
optionsFrame.ScrollBarThickness = 6
optionsFrame.ScrollBarImageColor3 = Color3.fromRGB(180,180,180)
optionsFrame.Active = true
optionsFrame.Parent = dropdownBase
optionsFrame.ZIndex = 998

-- Layout
local layout = Instance.new("UIListLayout")
layout.Padding = UDim.new(0,2)
layout.SortOrder = Enum.SortOrder.LayoutOrder
layout.Parent = optionsFrame

-- Update canvas size
local function updateCanvas()
    optionsFrame.CanvasSize = UDim2.new(0,0,0,layout.AbsoluteContentSize.Y)
end
layout:GetPropertyChangedSignal("AbsoluteContentSize"):Connect(updateCanvas)
task.defer(updateCanvas)

-- Add option buttons
for i, soundName in ipairs(soundOptions) do
    local btn = Instance.new("TextButton")
    btn.Size = UDim2.new(1,0,0,itemHeight)
    btn.BackgroundColor3 = Color3.fromRGB(28,28,28)
    btn.Text = soundName
    btn.TextColor3 = COL_TEXT
    btn.Font = Enum.Font.Gotham
    btn.TextSize = 16
    btn.ZIndex = 1000
    btn.Parent = optionsFrame

    btn.MouseButton1Click:Connect(function()
        currentSound.Text = soundName
        _G.HitSoundChoice = soundName
        optionsFrame.Visible = false
        dropdownOpen = false
        updateHitMarkerSound()
        print("Selected sound:", soundName)
    end)
end

-- Toggle dropdown visibility
dropdownBase.MouseButton1Click:Connect(function()
    dropdownOpen = not dropdownOpen
    optionsFrame.Visible = dropdownOpen
end)

-- Auto-close dropdown when clicking outside
UserInputService.InputBegan:Connect(function(input, gameProcessed)
    if dropdownOpen and (input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch) then
        local mousePos = UserInputService:GetMouseLocation()
        local guiPos = dropdownBase.AbsolutePosition
        local guiSize = dropdownBase.AbsoluteSize
        if not (mousePos.X >= guiPos.X and mousePos.X <= guiPos.X + guiSize.X and
                mousePos.Y >= guiPos.Y and mousePos.Y <= guiPos.Y + guiSize.Y + optionsFrame.AbsoluteSize.Y) then
            dropdownOpen = false
            optionsFrame.Visible = false
        end
    end
end)


-- SIDEBAR TABS
local tabs = {
	{ name = "Home",      page = home },
	{ name = "Main",      page = main },
	{ name = "Visuals",   page = farming },
	{ name = "Rage",      page = killer },
	{ name = "Misc",      page = misc },
}

local buttons = {}
local function makeTabButton(text, selected)
	local b = Instance.new("TextButton")
	b.AutoButtonColor = false
	b.Size = UDim2.new(1, -20, 0, 44)
	b.BackgroundColor3 = selected and COL_ACCENT or Color3.fromRGB(26,26,26)
	b.Text = "  "..text
	b.TextXAlignment = Enum.TextXAlignment.Left
	b.TextColor3 = COL_TEXT
	b.Font = Enum.Font.Gotham
	b.TextSize = 16
	b.Parent = sidebar
	roundify(b,8)

	local stroke = Instance.new("UIStroke")
	stroke.Thickness = 1
	stroke.Color = Color3.fromRGB(55,55,55)
	stroke.Transparency = selected and 1 or 0.35
	stroke.Parent = b

	return b
end

local function selectTab(idx)
	for i, t in ipairs(tabs) do
		t.page.Visible = (i == idx)
		local b = buttons[i]
		b.BackgroundColor3 = (i == idx) and COL_ACCENT or Color3.fromRGB(26,26,26)
		b:FindFirstChildOfClass("UIStroke").Transparency = (i == idx) and 1 or 0.35
	end
end

for i, t in ipairs(tabs) do
	local b = makeTabButton(t.name, i == 2)
	buttons[i] = b
	b.MouseButton1Click:Connect(function()
		selectTab(i)
	end)
end

-- Start on Main
selectTab(1)
